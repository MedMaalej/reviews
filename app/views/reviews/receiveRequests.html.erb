<body>
<link href="plugin_assets/reviews/bstrp/css/bootstrap.min.css" rel="stylesheet">
 <link rel="stylesheet" href="plugin_assets/reviews/awesomplete/awesomplete.css" />
 <script src="plugin_assets/reviews/awesomplete/awesomplete.js" async></script>
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
 <!-- Include all compiled plugins (below), or include individual files as needed -->
 <script src="plugin_assets/reviews/bstrp/js/bootstrap.min.js"></script>
<br>
<h3> Incoming review requests </h3> <b><span class="label label-default"><%= @incomingRequests.size %> pending  requests</span></b> <br> <br>
<table class="table">
<th> Developer  </th>
<th> Branch </th>
<th> Project</th>
<th> Accept/Reject review request </th>
<form role="form" name="fAcceptRefuseReq" action="receiveRequests">
<%
i = 0
@incomingRequests.each do |request|
%>
   <tr><td> <%= User.where(id: request['userId']).pluck('firstname')[0] %> &nbsp
   <%= User.where(id: request['userId']).pluck('lastname')[0] %> </td>
   <td> <%= request['branchName']  %></td>
   <td> <%= Project.where(id: request['projectId']).pluck('name') [0]   %> </td>
   <td>     
        <button class="btn btn-success"  id=<%= i %>   onclick="acceptReview()">Accept request</button> 
        <input type="hidden" value=<%= request['id']  %>" id="currentReview" name="currentReview">
        <button class="btn btn-danger" name="btn-reject" id="btn-reject">Reject request</button>  
        <button class="btn btn-primary" name="btn-postpone" id="btn-postpone">Postpone review</button>
     
      
   </td>
   </tr>
<%

i = i + 1
end
%>
<input type="hidden" name="rAccept" id="rAccept">
<input type="hidden" value=<%= @project %> id="project_id" name="project_id">

</form>
</table>

<h3> Accepted review requests </h3> <br> <br>
<table class="table">
<th> Developer  </th>
<th> Branch </th>
<th> Project</th>
<th> Start code review </th>
<form role="form" name="fCodeReview" action="codeReview">
<%
@acceptedIncomingRequests.each do |request|
%>
   <tr><td> <%= User.where(id: request['userId']).pluck('firstname')[0] %> &nbsp
   <%= User.where(id: request['userId']).pluck('lastname')[0] %> </td>
   <td> <%= request['branchName']  %></td>
   <td> <%= Project.where(id: request['projectId']).pluck('name') [0]   %> </td>
   <td>
        <button class="btn btn-info" name="btn-rev" id="btn-rev" onclick="startReview()">Start review</button>
        <input type="hidden" value=<%= Project.where(id: request['projectId']).pluck('name') [0] %> id="projectName" name="projectName">
     

   </td>
   </tr>
<%
end
%>
<input type="hidden" value=<%= request['branchName']  %> id="branchName" name="branchName">
<input type="hidden" value=0 id="rStart" name="rStart">
<input type="hidden" value=<%= @project %> id="project_id" name="project_id">
</form>
</table>

</body>
<script type="text/javascript">
   
   function acceptReview() {   
      document.getElementById("rAccept").value = 1;
   }
   function startReview() {
      document.getElementById("rStart").value = 1;
   }
  
</script>
